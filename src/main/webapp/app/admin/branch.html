<#include "/app/common/layout/__backstagemainlayout.html"/>
<#assign pageCss>
<link rel="stylesheet" href="${ContextPath}/plugin/ztree/css/zTreeStyle/zTreeStyle.css" />
	<style type="text/css">
.ztree li span.button.pIcon01_ico_open{margin-right:2px; background: url(${ContextPath}/plugin/ztree/css/zTreeStyle/img/diy/1_open.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}
.ztree li span.button.pIcon01_ico_close{margin-right:2px; background: url(${ContextPath}/plugin/ztree/css/zTreeStyle/img/diy/1_close.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}
.ztree li span.button.pIcon02_ico_open, .ztree li span.button.pIcon02_ico_close{margin-right:2px; background: url(${ContextPath}/plugin/ztree/css/zTreeStyle/img/diy/2.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}
.ztree li span.button.icon01_ico_docu{margin-right:2px; background: url(${ContextPath}/plugin/ztree/css/zTreeStyle/img/diy/3.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}
.ztree li span.button.icon02_ico_docu{margin-right:2px; background: url(${ContextPath}/plugin/ztree/css/zTreeStyle/img/diy/4.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}
.ztree li span.button.icon03_ico_docu{margin-right:2px; background: url(${ContextPath}/plugin/ztree/css/zTreeStyle/img/diy/5.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}
.ztree li span.button.icon04_ico_docu{margin-right:2px; background: url(${ContextPath}/plugin/ztree/css/zTreeStyle/img/diy/6.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}
.ztree li span.button.icon05_ico_docu{margin-right:2px; background: url(${ContextPath}/plugin/ztree/css/zTreeStyle/img/diy/7.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}
.ztree li span.button.icon06_ico_docu{margin-right:2px; background: url(${ContextPath}/plugin/ztree/css/zTreeStyle/img/diy/8.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}
	</style>
</#assign>
<#assign pageJavascript>
<script src="${ContextPath}/plugin/ztree/js/jquery.ztree.core-3.5.js"></script>
<script src="${ContextPath}/plugin/ztree/js/jquery.ztree.excheck-3.5.js"></script>
<SCRIPT type="text/javascript">
		<!--
		var setting = {	
			check:{
				enable:true,
			},
			data:{
				simpleData:{
					enable:true,
					idKey:"id",
					pIdKey:"pId",
					rootPId:null,
				},
			},
			view:{
				showIcon: true,
				showLine: true,
			},
		};

		var zNodes =[
			{ id:1, pId:0, name:"随意勾选 1", open:true},
			{ id:11, pId:1, name:"随意勾选 1-1", open:true},
			{ id:111, pId:11, name:"随意勾选 1-1-1"},
			{ id:112, pId:11, name:"随意勾选 1-1-2"},
			{ id:12, pId:1, name:"随意勾选 1-2", open:true},
			{ id:121, pId:12, name:"随意勾选 1-2-1"},
			{ id:122, pId:12, name:"随意勾选 1-2-2"},
			{ id:2, pId:0, name:"随意勾选 2", checked:true, open:true},
			{ id:21, pId:2, name:"随意勾选 2-1"},
			{ id:22, pId:2, name:"随意勾选 2-2", open:true},
			{ id:221, pId:22, name:"随意勾选 2-2-1", checked:true},
			{ id:222, pId:22, name:"随意勾选 2-2-2"},
			{ id:23, pId:2, name:"随意勾选 2-3"}
		];

		$(document).ready(function(){
			$('.mytree').click(function(){
				$('#zTree').modal();
				$.fn.zTree.init($("#treeDemo"), setting, zNodes);
			});
		});
		//-->
	</SCRIPT>
</#assign>
<@mainlayout pageJavascript=pageJavascript pageCss=pageCss currentMenu="organizationFlag-branchFlag-branchsListFlag">

<div class="page-header">
	<h1>
		单位管理 
		<small> <i class="ace-icon fa fa-angle-double-right"></i> 单位列表</small>
	</h1>
</div>
<form class="bs-example bs-example-form" role="form" action="${ContextPath}/admin/branch" method="post">
	<div class="row">
			<div class="col-xs-4" >
				<div class="input-group">
					<span class="input-group-addon">关键字</span> 
					<input class="form-control" id="branch" name="branch" value="${(branch)!}" placeholder="单位名称" type="text" autocomplete="off">
					<span class="input-group-btn">
						<button class="btn btn-sm btn-default">
							<span class="glyphicon glyphicon-search"></span> 查询
						</button>
					</span>
				</div>
			</div>
	</div>
</form>
<div class="hr hr-dotted"></div>
<table class="table table-bordered table-hover">
		<thead>
			<tr>
				<th width="2%">序号</th>
				<th width="10%">单位名称</th>
				<th width="5%">创建时间</th>
				<th width="4%">状态</th>
				<th width="4%">操作</th>
			</tr>
		</thead>
		<tbody>
			<#list branchPage.getList() as branch>
			<tr>
				<td>${(branch_index+1)!}</td>
				<td> ${(branch.name)!}</td>
				<td> ${(branch.created_at)!}</td>
				<td><#if branch.deleted_at??>
					<b>
					<span class="red">禁用</span>
					<#else>
					<span class="gray">正常</span>
					</#if>
					</b>
				</td>
				<td>
				<div class="action-buttons">
				<a class="btn btn-minier btn-primary btn-xs"  href="${ContextPath}/admin/branch/edit?id=${(branch.id)!}" >编辑</a>
				<#if branch.deleted_at??>
				<a class="btn btn-minier btn-danger btn-xs"  href="${ContextPath}/admin/branch/on?id=${(branch.id)!}" >启用</a>
				<#else>
				<a class="btn btn-minier btn-primary btn-xs"  href="${ContextPath}/admin/branch/off?id=${(branch.id)!}" >禁用</a>
				</#if>
				<a class="btn btn-minier btn-primary btn-xs mytree" href="#" >部门</a>
				</div>
				</td>
			</tr>
			</#list>
			<#if branchPage.getList().size()!=10>
			<#assign size=(10-branchPage.getList().size())>
				<#list 1..size as t>
					<tr>
						<td>${(branchPage.getList().size()+t)!}</td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>
				</#list>
			</#if>
		</tbody>
	</table>
	<#include "/app/common/inc/_paginate.html" />
	<@paginate currentPage=branchPage.pageNumber totalPage=branchPage.totalPage actionUrl="/admin/branch/" />
<#include "branch/_apartmentTree.html" />
</@mainlayout>